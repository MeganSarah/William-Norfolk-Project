---
title: "Exploratory Data Analysis"
author: "William Norfolk"
date: "10/9/2019"
output: word_document
---

Load the required libraries for exploratory analysis.

```{r}
library(readxl)
library(dplyr)
library(tidyverse)
library(forcats)
library(ggthemes)
library(plotly)
library(knitr)
library(naniar)
library(broom)
```

Load the processed data from the RDS. Then take a look!

```{r}
WQ_clean_data <- readRDS("../../data/processed_data/processeddata.rds")

glimpse(WQ_clean_data)
```


```{r}
island_side_filter <- filter(WQ_clean_data, !is.na(island_side))

site_type_filter <- filter(WQ_clean_data, !is.na(site_type))
```


Now lets generate some plots to compare ocean vs bay. 

Looks like pH is pretty consistent between the ocean and bayside.

```{r}
island_side_filter %>% ggplot() + 
  geom_boxplot(aes(x = island_side, y = ph))

island_side_filter %>% ggplot() + 
  geom_jitter(aes(x = island_side, y = ph))

bay_v_ocean_ph <- ggplot(island_side_filter, aes(x = island_side, y = ph, color = island_side)) + geom_violin(width = 1) + geom_jitter(alpha = 0.25) + ggtitle("Bay vs. Ocean pH") + xlab("Island Side") + ylab("pH") + theme(legend.position = "none", axis.text.x = element_text(face = "bold"))

bay_v_ocean_ph

ggsave(filename = "../../results/bay_v_ocean_ph.png",plot = bay_v_ocean_ph) 


```

We will save the violin + jitter plots for use later.



Looks like salinity may be a little more interesting. Ocean side appears to have a narrower range of values compared to the bayside,  which is expected due to the size of the body of water.

```{r}

island_side_filter %>% ggplot() + 
  geom_boxplot(aes(x = island_side, y = salinity))

island_side_filter %>% ggplot() + 
  geom_jitter(aes(x = island_side, y = salinity))

bay_v_ocean_salinity <- ggplot(island_side_filter, aes(x = island_side, y = salinity, color = island_side)) + geom_violin(width = 1) + geom_jitter(alpha = 0.25) + ggtitle("Bay vs. Ocean Salinity") + xlab("Island Side") + ylab("Salinity (ppt)") + theme(legend.position = "none", axis.text.x = element_text(face = "bold"))

bay_v_ocean_salinity

ggsave(filename = "../../results/bay_v_ocean_salinity.png",plot = bay_v_ocean_salinity) 

```



```{r}
island_side_filter %>% ggplot() + 
  geom_boxplot(aes(x = island_side, y = water_temp))

island_side_filter %>% ggplot() + 
  geom_jitter(aes(x = island_side, y = water_temp))

bay_v_ocean_water_temp <- ggplot(island_side_filter, aes(x = island_side, y = water_temp, color = island_side)) + geom_violin(width = 1) + geom_jitter(alpha = 0.25) + ggtitle("Bay vs. Ocean Water Temperature") + xlab("Island Side") + ylab("Water Temperature (C)") + theme(legend.position = "none", axis.text.x = element_text(face = "bold"))

bay_v_ocean_water_temp 

ggsave(filename = "../../results/bay_v_ocean_water_temp.png",plot = bay_v_ocean_water_temp) 

```

```{r}
island_side_filter %>% ggplot() + 
  geom_boxplot(aes(x = island_side, y = dissolved_oxygen))

island_side_filter %>% ggplot() + 
  geom_jitter(aes(x = island_side, y = dissolved_oxygen))

bay_v_ocean_dissolved_oxygen <- ggplot(island_side_filter, aes(x = island_side, y = dissolved_oxygen, color = island_side)) + geom_violin(width = 1) + geom_jitter(alpha = 0.25) + ggtitle("Bay vs. Ocean Dissolved Oxygen") + xlab("Island Side") + ylab("Dissolved Oxygen (mg/L)") + theme(legend.position = "none", axis.text.x = element_text(face = "bold"))

bay_v_ocean_dissolved_oxygen

ggsave(filename = "../../results/bay_v_ocean_dissolved_oxygen.png",plot = bay_v_ocean_dissolved_oxygen) 

```

```{r}
filter(WQ_clean_data, !is.na(island_side)) %>% ggplot() + 
  geom_boxplot(aes(x = island_side, y = ammonia))

filter(WQ_clean_data, !is.na(island_side)) %>% ggplot() + 
  geom_jitter(aes(x = island_side, y = ammonia))

bay_v_ocean_ammonia <- ggplot(island_side_filter, aes(x = island_side, y = ammonia, color = island_side)) + geom_violin(width = 1) + geom_jitter(alpha = 0.25) + ggtitle("Bay vs. Ocean Ammonia") + xlab("Island Side") + ylab("Ammonia (mg/L)") + theme(legend.position = "none", axis.text.x = element_text(face = "bold"))

bay_v_ocean_ammonia

ggsave(filename = "../../results/bay_v_ocean_ammonia.png",plot = bay_v_ocean_ammonia) 

```



```{r}
site_type_filter %>% ggplot() + 
  geom_jitter(aes(x = site_type, y = salinity))

site_type_salinity <- ggplot(island_side_filter, aes(x = site_type, y = salinity, color = site_type)) + geom_violin(width = 1) + geom_jitter(alpha = 0.25) + ggtitle("Salinity by Site Type") + xlab("") + ylab("Salinity (ppt)") + theme(legend.position = "none", axis.text.x = element_text(face = "bold"))

site_type_salinity

ggsave(filename = "../../results/site_type_salinity.png",plot = site_type_salinity) 

```

```{r}
site_type_filter %>% ggplot() + 
  geom_jitter(aes(x = site_type, y = water_temp))

site_type_water_temp <- ggplot(island_side_filter, aes(x = site_type, y = water_temp, color = site_type)) + geom_violin(width = 1) + geom_jitter(alpha = 0.25) + ggtitle("Water Temperature by Site Type") + xlab("") + ylab("Water Temperature (C)") + theme(legend.position = "none", axis.text.x = element_text(face = "bold"))

site_type_water_temp

ggsave(filename = "../../results/site_type_water_temp.png",plot = site_type_water_temp) 


```

```{r}
site_type_filter %>% ggplot() + 
  geom_jitter(aes(x = site_type, y = dissolved_oxygen))

site_type_dissolved_oxygen <- ggplot(island_side_filter, aes(x = site_type, y = dissolved_oxygen, color = site_type)) + geom_violin(width = 1) + geom_jitter(alpha = 0.25) + ggtitle("Dissolved Oxygen by Site Type") + xlab("") + ylab("Dissolved Oxygen (mg/L)") + theme(legend.position = "none", axis.text.x = element_text(face = "bold"))

site_type_dissolved_oxygen

ggsave(filename = "../../results/site_type_dissolved_oxygen.png",plot = site_type_dissolved_oxygen) 

```

```{r}
site_type_filter %>% ggplot() + 
  geom_jitter(aes(x = site_type, y = ammonia))

site_type_ammonia <- ggplot(island_side_filter, aes(x = site_type, y = ammonia, color = site_type)) + geom_violin(width = 1) + geom_jitter(alpha = 0.25) + ggtitle("Ammonia by Site Type") + xlab("") + ylab("Ammonia (mg/L)") + theme(legend.position = "none", axis.text.x = element_text(face = "bold"))

site_type_ammonia

ggsave(filename = "../../results/site_type_ammonia.png",plot = site_type_ammonia) 

```

Now that we have baseline visuals of the differet island sides and site types, lets start to look at some seasonal changes and see if we can identify the presence of Hurricane Irma in the data.

```{r}
site_type_filter %>% ggplot() +
  geom_jitter(aes(x = Month, y = water_temp, color = site_type)) + facet_wrap(~Year)
```

```{r}
site_type_filter %>% ggplot() +
  geom_jitter(aes(x = Month, y = ph, color = site_type)) + facet_wrap(~Year)

```

```{r}
site_type_filter %>% ggplot() +
  geom_jitter(aes(x = Month, y = dissolved_oxygen, color = site_type)) + facet_wrap(~Year)
```

```{r}
site_type_filter %>% ggplot() +
  geom_jitter(aes(x = Month, y = salinity, color = site_type)) + facet_wrap(~Year)
```

```{r}

site_type_filter %>% ggplot() +
  geom_jitter(aes(x = Month, y = ammonia, color = site_type)) + facet_wrap(~Year)

```


To Do:
1. Make Bay vs Ocean plots for each paremeter
2. Make a plot of site type for each parameter
3. geom_line for view hurricane Irma